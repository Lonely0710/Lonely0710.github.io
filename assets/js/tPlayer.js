var styleChange={pause:{},play:{},plsbutton:{}};function initAudio(t){var e=t.attr("t_name"),a=t.attr("t_cover"),i=t.attr("t_artist");$(".title").text(" - "+e),$(".artist").text(i),$("#t_cover").html("<img src="+a+">")}styleChange.play.change=function(){$("#play").addClass("hidden"),$("#pause").removeClass("hidden")},styleChange.pause.change=function(){$("#pause").addClass("hidden"),$("#play").removeClass("hidden")},styleChange.plsbutton.change=function(){$("#t_pls_show").addClass("selectpls"),$("#t_pls_show").removeClass("noselectpls")},styleChange.plsbutton.recovery=function(){$("#t_pls_show").addClass("noselectpls"),$("#t_pls_show").removeClass("selectpls")},$(document).ready((function(){var t,e,a,i,l,n=0;$("#playlist ul li a").click((function(){$("#t_title_info").animate({top:"-1.5em",opacity:"hide"},0),initAudio($(this).parent("li")),$("#error").text(""),styleChange.play.change(),console.log(i),i&&(i[0].pause(),i[0].currentTime=0,$("li").removeClass("active")),i=$(this).next("audio"),$(this).parent("li").addClass("active"),i[0].play()})),$("#t_progress").slider({value:0,orientation:"horizontal",range:"min",animate:!0,step:1}),$("audio").on("timeupdate",(function(){i[0].volume=a/100,d=this.duration,c=this.currentTime,curM=Math.floor(c/60),curS=Math.round(c-60*curM),$("#current").text(curM+":"+curS),$("#t_progress").slider({max:d,min:0,value:c})})),$("audio").on("playing",(function(){t=this.duration,e=Math.floor(t/60)+":"+Math.round((t-Math.floor(t/60))/10),$("#duration").text(e),$(this).parent("li").addClass("active"),$("#t_title_info").animate({top:"0em",opacity:"show"},500)})),$("audio").on("ended",(function(){i=(i=$(this).parent("li").next("li").first()).children("audio"),$(this).parent("li").addClass("active");var t=$("li.active").next();$("li").removeClass("active"),i[0]?(initAudio(t),i[0].play()):($("#error").text("最后一首歌！"),$("#t_cover").html('<img src="/assets/images/logo.png">'))})),$("#play").click((function(){i?(i[0].play(),styleChange.play.change(),$("#error").text("")):$("#error").text("请先选择要播放的歌曲！")})),$("#pause").click((function(){i?(i[0].pause(),styleChange.pause.change()):$("#error").text("请先选择要播放的歌曲！")})),$("#next").click((function(){i[0].pause(),i[0].currentTime=0,i=(i=i.parent("li").next("li").first()).children("audio");var t=$("li.active").next();$("#t_title_info").animate({top:"-1.25em",opacity:"hide"},0),$("li").removeClass("active"),i[0]?(initAudio(t),i[0].play()):($("#error").text("已经到底啦，请选择歌曲！"),$("#t_cover").html('<img src="/assets/images/logo.png">'),i=null)})),$("#prev").click((function(){i[0].pause(),i[0].currentTime=0,i=(i=i.parent("li").prev("li").last()).children("audio");var t=$("li.active").prev();$("li").removeClass("active"),$("#t_title_info").animate({top:"-1.25em",opacity:"hide"},0),i[0]?(initAudio(t),i[0].play()):($("#error").text("已经到顶啦，请选择歌曲！"),$("#t_cover").html('<img src="/assets/images/logo.png">'),i=null)})),$("#rangeVal").slider({value:60,orientation:"horizontal",range:"min",animate:!0,step:1}),a=$("#rangeVal").slider("value"),$("#val").text(a);var s=$("#val");s.hide(),$("#rangeVal").slider({start:function(t,e){s.fadeIn("fast")},stop:function(t,e){s.fadeOut("fast")},slide:function(t,e){a=e.value,s.css("left",a-30).text(e.value),$("#val").text(a),i?i[0].volume=a/100:$("#error").text("请先选择要播放的歌曲！")}}),$("#t_progress").slider({start:function(t,e){i[0].pause()},stop:function(t,e){l=e.value,i[0].currentTime=l,i[0].play(),styleChange.play.change()}}),$("#t_pls_show").click((function(){0==n?(styleChange.plsbutton.change(),n=1):(styleChange.plsbutton.recovery(),n=0),$("#playlist").slideToggle()}))}));